<% include ./partials/header.ejs %>
<script src="./javascripts/feed.js"></script>
  <div class="w-full min-h-screen bg-zinc-900 text-white py-5"> <!--Step 25: Importing posts props-->
    <div class="w-full px-4 flex items-center justify-between">
      <img class="w-1/4" src="/images/logo.png" alt="">
      <div class="icons -mt-2 flex gap-5 items-center">
        <i class="text-[1.4rem] ri-heart-3-line"></i>
        <i class="text-[1.4rem] ri-messenger-line"></i>
      </div>
    </div>
    <div class="story flex overflow-x-auto whitespace-no-wrap">
      <div class="circle flex-shrink-0 relative m-0">
        <div
          class="gradient w-[21vw] h-[18vw] rounded-full flex items-center justify-center ">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
            <img class="w-full h-full object-cover" src="/images/uploads/<%= user.profileImage %>" alt="img">
            <i class="ri-add-circle-fill"></i>
          </div>
          <div class="inner flex rounded-full w-[4.8vw] h-[4.8vw] justify-center items-center bg-white relative top-[23px] left-[-18px]">
            <i class="ri-add-circle-fill text-blue-500"></i>
          </div>
          
        </div>
        
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden px-[4%] py-[4%] bg-white flex items-center justify-center">
            <img class="w-[99.9%] h-[99.9%] rounded-full object-cover"
              src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=2550&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden px-[4%] py-[4%] bg-white flex items-center justify-center">
            <img class="w-[99.9%] h-[99.9%] rounded-full object-cover"
              src="https://images.unsplash.com/photo-1570158268183-d296b2892211?q=80&w=3456&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden px-[4%] py-[4%] bg-white flex items-center justify-center">
            <img class="w-[99.9%] h-[99.9%] rounded-full object-cover"
              src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=2550&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden px-[4%] py-[4%] bg-white flex items-center justify-center">
            <img class="w-[99.9%] h-[99.9%] rounded-full object-cover"
              src="https://images.unsplash.com/photo-1570158268183-d296b2892211?q=80&w=3456&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden px-[4%] py-[4%] bg-white flex items-center justify-center">
            <img class="w-[99.9%] h-[99.9%] rounded-full object-cover"
              src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=2550&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden px-[4%] py-[4%] bg-white flex items-center justify-center">
            <img class="w-[99.9%] h-[99.9%] rounded-full object-cover"
              src="https://images.unsplash.com/photo-1570158268183-d296b2892211?q=80&w=3456&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
    </div>
    <div class="mt-8 ml-8">
      
        <h1 class="font-semibold mb-3">Suggestions for You</h1>
        
      
      
      <div class="story flex overflow-x-auto whitespace-no-wrap">
        <% allusers.reverse().forEach(function(elem){ %>
          <div class="alert alert-success alert-dismissible fade show flex flex-col justify-center items-center h-[230px] w-[230px] bg-white mr-3 opacity-86" role="alert">
            <div class="w-full flex items-center justify-center">
              <button type="button" class="btn-close mb-5" data-bs-dismiss="alert" aria-label="Close"><i class="fa-solid fa-xmark font-bold text-2xl text-black"></i></button>
    
            </div>
            
            <div class="w-full h-full flex flex-col justify-center items-center ml-6">
              <img src="/images/uploads/<%= elem.profileImage %>" alt="" class="w-[90px] h-[90px] rounded-full bg-green-500 object-cover flex items-center justify-center">
              <h1 class="text-2xl font-semibold mt-2"><%= elem.name %></h1>
              <button id="followbtn" class="followbtn h-[30px] w-[126px] bg-blue-500 rounded-md mt-4 text-white font-bold" >Follow</button>

              
    
            </div>
            
            
          </div>

        <% }) %>
        
        
        
      </div>
      
      
      
    </div>
    
    <div class="posts mb-20">
      
      <% posts.reverse().forEach(function(elem){ %> <!--Step 26: Reversing the posts array in "reverse()"-->
        <div class="post mt-10 w-full min-h-[50vh]">
          <div class="title px-4 flex items-center gap-2">
            <a class="w-[8vw] h-[8vw] bg-sky-100 rounded-full overflow-hidden">
              <img class="w-full h-full object-cover" src="/images/uploads/<%= elem.user.profileImage %>" alt="image">
            </a>
            <h4 class="text-sm"><%= elem.user.username %></h4>
            <h6 class="text-xs opacity-30">1d</h6>
          </div>
          <div class="w-full mt-4 overflow-hidden relative">
            <a href="#"><i class="ri-more-2-fill absolute right-5 top-5"></i></a>
            <img class="w-full h-full object-cover" src="/images/uploads/<%= elem.picture %>" alt="mimg">
          </div>
          <div class="options w-full px-4 flex justify-between items-center text-[1.4rem]">
            <div class="flex gap-3 mt-2">

              <a href="/like/posts/<%= elem._id %>"><!--Step 36: Activating like button-->

                <% if(elem.likes.indexOf(user._id) !== -1 ) { %> <!--Step 39: If user's id there in post's like array, it will turn the heart symbol filled-->
                  <i class="ri-heart-3-fill text-red-600"></i>

                <% } else { %>
                <i class="ri-heart-3-line"></i> <!--Step 39: else , it will be simple heart symbol-->

                <% } %>
              </a> 

              <i class="ri-chat-3-line"></i>
              <i class="ri-share-circle-line"></i>
            </div>
            <i class="ri-bookmark-line"></i>
          </div>
          <h3 class="px-4 mt-2 text-sm leading-none tracking-tight"><%= elem.likes.length %> Likes</h3>
          <div class="mt-2">
            <h2 class="text-white font-light text-sm m-2"><span class="font-semibold pl-4 pr-2"><%= elem.user.username%></span>
            <%= elem.caption %></h2>

          </div>
          
        </div>
        

      <% }) %>
      
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  </div>
  <% include ./partials/footer.ejs %>